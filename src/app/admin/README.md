# Admin Security Bypass System

## Overview

This document outlines the security bypass system implemented for the TOPAY Foundation admin dashboard. The system provides two methods of authentication:

1. **Admin Wallet Authentication**: Access is granted to specific wallet addresses designated as admin wallets.
2. **Bypass Key Authentication**: Access can be granted using a special bypass key in the URL query parameters.

## Implementation Details

### Files Created/Modified

1. **`/src/middleware.ts`**
   - Server-side middleware that intercepts requests to admin routes
   - Checks for valid admin wallet or bypass key
   - Redirects unauthorized users to the home page

2. **`/src/lib/adminAuth.ts`**
   - Utility functions for admin authentication
   - Contains the list of admin wallet addresses
   - Contains the bypass key validation logic

3. **`/src/app/admin/layout.tsx`**
   - Client-side authentication check
   - Shows loading and unauthorized states
   - Redirects unauthorized users to the home page

4. **`/src/components/AdminSidebar.tsx`**
   - Displays admin status badges
   - Shows whether access is granted via admin wallet or bypass key

5. **`/src/components/Sidebar.css`**
   - Added styles for admin status badges

6. **`/src/app/admin/admin-layout.css`**
   - Added styles for loading and unauthorized states

## How to Use

### Admin Wallet Access

To grant admin access to a wallet address:

1. Add the wallet address to the `ADMIN_WALLETS` array in `/src/lib/adminAuth.ts`
2. Connect with that wallet to access the admin dashboard

### Bypass Key Access

To access the admin dashboard using the bypass key:

1. Append `?adminKey=topay-admin-bypass-key` to any admin URL
   - Example: `https://your-domain.com/admin?adminKey=topay-admin-bypass-key`

## Security Considerations

**Important:** For production deployment, consider the following security enhancements:

1. Move the admin wallet addresses to environment variables
2. Use a more secure, randomly generated bypass key stored in environment variables
3. Implement a proper authentication system with JWT tokens or similar
4. Add rate limiting to prevent brute force attacks
5. Add IP-based restrictions for admin access
6. Implement two-factor authentication for admin access

## Troubleshooting

If you encounter issues with admin access:

1. Ensure your wallet address is correctly added to the `ADMIN_WALLETS` array (case-sensitive)
2. Check that you're using the correct bypass key
3. Clear browser cookies and cache
4. Ensure the middleware is properly deployed
